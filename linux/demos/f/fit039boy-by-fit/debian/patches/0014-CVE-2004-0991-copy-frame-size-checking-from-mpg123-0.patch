From: Simon McVittie <smcv@debian.org>
Date: Sun, 16 Mar 2014 21:46:34 +0000
Subject: CVE-2004-0991: copy frame size checking from mpg123/0.59r-18

Author: Daniel Kobras
Origin: vendor, Debian (mpg123/0.59r-18)
---
 mpglib/common.c | 5 +++++
 1 file changed, 5 insertions(+)

--- a/mpglib/common.c
+++ b/mpglib/common.c
@@ -143,6 +143,10 @@
 	default:
 		fprintf(stderr,"Sorry, unknown layer type.\n");
 		return (0);
+		if (fr->framesize > MAXFRAMESIZE) {
+		fprintf(stderr,"Frame size too big: %d\n", fr->framesize+4-fr->padding);
+		return (0);
+		}
 	}
 	return 1;
 }
@@ -237,5 +241,3 @@
 	return rval>>7;
 }
 
-
-
