From: Simon McVittie <smcv@debian.org>
Date: Sun, 16 Mar 2014 21:46:34 +0000
Subject: CVE-2004-0991: copy frame size checking from mpg123/0.59r-18

Author: Daniel Kobras
Origin: vendor, Debian (mpg123/0.59r-18)
---
 LIBS/mpglib/common.c | 5 +++++
 1 file changed, 5 insertions(+)

--- a/LIBS/mpglib/common.c
+++ b/LIBS/mpglib/common.c
@@ -122,6 +122,11 @@
       return (0);
     }
 
+    if (fr->framesize > MAXFRAMESIZE) {
+      fprintf(stderr,"Frame size too big: %d\n", fr->framesize+4-fr->padding);
+      return (0);
+    }
+
     switch(fr->lay)
     {
       case 1:
