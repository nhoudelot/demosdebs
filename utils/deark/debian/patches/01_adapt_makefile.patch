Description: updating makefile
 updated makefile to make it more compatible with packaging
Author: Nicolas HOUDELOT (nicolas@demosdebs.org)
Last-Update: 2020-04-18
---
This patch header follows DEP-3: http://dep.debian.net/deps/dep3/
--- a/Makefile
+++ b/Makefile
@@ -20,6 +20,14 @@
 
 INCLUDES:=-Isrc
 
+#variables dâ€™installation
+INSTALL := install
+INSTALL_DIR     := $(INSTALL) -p -d -o root -g root  -m  755
+INSTALL_PROGRAM := $(INSTALL) -p    -o root -g root  -m  755
+prefix          := /usr
+exec_prefix     := $(prefix)
+bindir          := $(prefix)/bin
+
 ifeq ($(OS),Windows_NT)
 EXE_EXT:=.exe
 else
@@ -87,11 +95,11 @@
 
 DEARK1_A:=$(OBJDIR)/src/deark1.a
 $(DEARK1_A): $(OFILES_DEARK1)
-	$(AR) rcs $@ $^
+	$(AR) rcs $(PLUGIN) $@ $^
 
 DEARK2_A:=$(OBJDIR)/src/deark2.a
 $(DEARK2_A): $(OFILES_DEARK2)
-	$(AR) rcs $@ $^
+	$(AR) rcs $(PLUGIN) $@ $^
 
 MODS_AB_A:=$(OBJDIR)/modules/mods-ab.a
 MODS_CH_A:=$(OBJDIR)/modules/mods-ch.a
@@ -99,15 +107,15 @@
 MODS_PQ_A:=$(OBJDIR)/modules/mods-pq.a
 MODS_RZ_A:=$(OBJDIR)/modules/mods-rz.a
 $(MODS_AB_A): $(OFILES_MODS_AB)
-	$(AR) $(ARFLAGS) $@ $^
+	$(AR) $(ARFLAGS) $(PLUGIN) $@ $^
 $(MODS_CH_A): $(OFILES_MODS_CH)
-	$(AR) $(ARFLAGS) $@ $^
+	$(AR) $(ARFLAGS) $(PLUGIN) $@ $^
 $(MODS_IO_A): $(OFILES_MODS_IO)
-	$(AR) $(ARFLAGS) $@ $^
+	$(AR) $(ARFLAGS) $(PLUGIN) $@ $^
 $(MODS_PQ_A): $(OFILES_MODS_PQ)
-	$(AR) $(ARFLAGS) $@ $^
+	$(AR) $(ARFLAGS) $(PLUGIN) $@ $^
 $(MODS_RZ_A): $(OFILES_MODS_RZ)
-	$(AR) $(ARFLAGS) $@ $^
+	$(AR) $(ARFLAGS) $(PLUGIN) $@ $^
 
 # I'm sorry if your linker doesn't like this library order, but the link
 # command was getting so long that I've decided to start using helper
@@ -127,14 +135,13 @@
 	> $@
 endif
 
-DEARK_INSTALLDIR ?= /usr/local/bin
-INSTALL_TARGET:=$(DEARK_INSTALLDIR)/$(DEARK_EXE_BASENAME)
-install: $(INSTALL_TARGET)
-$(INSTALL_TARGET): $(DEARK_EXE)
-	install -s $(DEARK_EXE) $(DEARK_INSTALLDIR)
+install: $(DEARK_EXE)
+	$(INSTALL_DIR) $(DESTDIR)$(bindir)
+	-@$(RM_F) $(DESTDIR)$(bindir)/$(DEARK_EXE)
+	$(INSTALL_PROGRAM) $(DEARK_EXE) $(DESTDIR)$(bindir)
 
 clean:
-	rm -f $(OBJDIR)/src/*.[oad] $(OBJDIR)/modules/*.[oad] $(DEARK_EXE)
+	-@$(RM_F) -f $(OBJDIR)/src/*.[oad] $(OBJDIR)/modules/*.[oad] $(DEARK_EXE)
 
 ifeq ($(MAKECMDGOALS),dep)
 
