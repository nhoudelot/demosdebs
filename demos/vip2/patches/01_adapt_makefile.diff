--- a/Makefile
+++ b/Makefile
@@ -1,3 +1,4 @@
+SHELL = /bin/sh
 OBJS=Sources/BPeloche.o Sources/BSplineAff.o Sources/CilsBack.o   \
 	Sources/CilsBoule.o Sources/CilsCarotus.o Sources/Cils.o  \
 	Sources/CilsTextes.o Sources/ColonneAnim.o		  \
@@ -58,25 +59,60 @@
 	LIBS/mpglib/interface.o LIBS/mpglib/layer3.o		    \
 	LIBS/mpglib/tabinit.o
 
-CC=gcc
-CXX=g++
-CFLAGS=-O3 -ffast-math
-CXXFLAGS=$(CFLAGS)
-LDFLAGS=
+CC    = gcc
+CXX   = g++
+AR    = ar
+RANLIB = ranlib
+CFLAGS   += -O3 -flto -Wall -ffast-math
+CXXFLAGS += -O3 -flto -Wall -ffast-math
+LDFLAGS  += $(shell pkg-config glu x11 xxf86vm --libs) -ljpeg
+RM_F = rm -f
+INSTALL = install
+INSTALL_DIR     = $(INSTALL) -p -d -o root -g root  -m  755
+INSTALL_PROGRAM = $(INSTALL) -p    -o root -g root  -m  755
+INSTALL_DATA    = $(INSTALL) -p    -o root -g root  -m  644
+
+TARGET          = vip2
+
+prefix          = /usr
+exec_prefix     = $(prefix)
+bindir          = $(prefix)/bin
+datarootdir     = $(prefix)/share
+datadir         = $(prefix)/share/vip2
+
+PLUGIN := --plugin=$(shell gcc --print-file-name=liblto_plugin.so)
+
+#si code gcc4 compilé via gcc5 le standard par défaut était different
+GCCVERSIONGTEQ5 := $(shell expr `gcc -dumpversion | cut -f1 -d.` \>= 5)
+ifeq "$(GCCVERSIONGTEQ5)" "1"
+    CFLAGS += -std=gnu90
+    CXXFLAGS += -fabi-compat-version=2
+endif
+ifneq (,$(filter parallel=%,$(DEB_BUILD_OPTIONS)))
+ NUMJOBS = $(patsubst parallel=%,%,$(filter parallel=%,$(DEB_BUILD_OPTIONS)))
+ MAKEFLAGS += -j$(NUMJOBS)
+endif
 
-all: vip2
+export
+
+all: $(TARGET)
 CPPFLAGS=-IInclude -ILIBS/u3dLib/include -ILIBS/mpglib
 
 clean:
-	$(RM) $(OBJS) $(U3DOBJS) $(MPGOBJS) libu3d.a libmpg.a vip2
+	-@$(RM_F) $(OBJS) $(U3DOBJS) $(MPGOBJS) libu3d.a libmpg.a $(TARGET)
 
 libu3d.a: $(U3DOBJS)
-	ar rc libu3d.a $(U3DOBJS)
-	ranlib libu3d.a
+	$(AR) rc $(PLUGIN) libu3d.a $(U3DOBJS)
+	$(RANLIB) $(PLUGIN) libu3d.a
 
 libmpg.a: $(MPGOBJS)
-	ar rc libmpg.a $(MPGOBJS)
-	ranlib libmpg.a
+	$(AR) rc $(PLUGIN) libmpg.a $(MPGOBJS)
+	$(RANLIB) $(PLUGIN) libmpg.a
+
+$(TARGET): $(OBJS) libu3d.a libmpg.a
+	$(CXX) -flto -o $(TARGET) libu3d.a $(OBJS) libu3d.a libmpg.a $(LDFLAGS)
 
-vip2: $(OBJS) libu3d.a libmpg.a
-	$(CXX) -o vip2 libu3d.a $(OBJS) libu3d.a libmpg.a -lGL -lGLU -ljpeg -lXxf86vm -lX11
+install: $(TARGET)
+	$(INSTALL_DIR) $(DESTDIR)$(bindir)
+	-@$(RM_F) $(DESTDIR)$(bindir)/$(TARGET)
+	$(INSTALL_PROGRAM) $(TARGET) $(DESTDIR)$(bindir)
