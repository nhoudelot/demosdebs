--- a/acinclude.m4
+++ b/acinclude.m4
@@ -464,6 +464,23 @@
   AC_SUBST(NEED_SYS_FILIO)
 ])
 
+
+# Add a lib to current LIBS if it is not already there.
+# AC_ADD_LIB([FLAG])
+AC_DEFUN([AC_ADD_LIB],
+[
+  LIBS_addsave=[$LIBS]
+  if test "x$LIBS_addsave" != "x" ; then
+    flag=`echo "$1" | sed 's/-/\\\-/g'`
+    if test -z "`echo \"${LIBS}\" | grep \"${flag}\"`" ; then
+      LIBS="$LIBS_addsave $1"
+    fi
+  else
+    LIBS="$1"
+  fi
+])
+
+
 ##############################################################################
 # Loppu ######################################################################
 ##############################################################################
--- a/configure.ac
+++ b/configure.ac
@@ -1,7 +1,8 @@
 # Process this file with autoconf to produce a configure script.
 
 # Init
-AC_INIT([origami], [1], [foo@bar.com], [origami])
+AC_INIT([origami],[1],[foo@bar.com],[origami])
+AC_CONFIG_SRCDIR([src/drumsong.h])
 
 # J‰rjestelm‰n tyyppi
 AC_CANONICAL_BUILD
@@ -9,7 +10,7 @@
 AC_CANONICAL_TARGET
 
 # Automaken init
-AM_INIT_AUTOMAKE([dist-bzip2])
+AM_INIT_AUTOMAKE
 
 # Tarkistukset
 AC_PROG_CPP
@@ -17,21 +18,29 @@
 AC_PROG_CXX
 AC_PROG_MAKE_SET
 AC_PROG_RANLIB
+AC_PROG_INSTALL
+AC_PROG_LN_S
 
-AC_CHECK_HEADERS(math.h stdlib.h)
+AC_CHECK_HEADERS([math.h stdlib.h string.h])
+
+AC_TYPE_SIZE_T
+
+AC_FUNC_MALLOC
+AC_CHECK_FUNCS([floor pow sqrt])
 
 AC_STRIP_BINARIES
 AC_CHECK_GL([no])
 AC_CHECK_GTK([2.4.10], [no])
 AC_CHECK_SDL([1.2.4])
 AC_CHECK_SDL_IMAGE([no])
+AC_ADD_LIB([-lm])
 
 # Vapaavalintaiset jutut
 AC_CONDITIONAL_DEFINE([FLAG_ENABLE_GTK], [$gtk])
 AC_CONDITIONAL_DEFINE([FLAG_ENABLE_SDL_IMAGE], [$sdl_image])
 
 # M‰‰ritell‰‰n k‰ytett‰v‰t conffifilut ja ulostetaan
-AM_CONFIG_HEADER(src/config.h)
+AC_CONFIG_HEADERS([src/config.h])
 AC_CONFIG_FILES([Makefile src/Makefile])
 AC_OUTPUT
 
--- a/src/Makefile.am
+++ b/src/Makefile.am
@@ -2,5 +2,5 @@
 
 origami_SOURCES = origami.c
 
-noinst_PROGRAMS = origami
+bin_PROGRAMS = origami-by-faemiyah
 
